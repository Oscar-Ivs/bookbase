
<div class="col-6 col-md-4 col-lg-3 col-xl-2 d-flex">
  <div class="card flex-fill shadow-sm book-card">

    <!-- Cover with fixed 2:3 ratio -->
    <div class="position-relative">
      <div class="ratio ratio-2x3">
        <img src="{{ book.cover_url|default:'/static/img/book-placeholder.png' }}"
             alt="{{ book.title }}"
             class="card-img-top object-fit-contain"
             onerror="this.onerror=null;this.src='/static/img/book-placeholder.png';">
      </div>

      <!-- Status badge -->
      <span class="position-absolute bottom-0 start-0 m-1 badge
                   {% if book.status == 'read' %}bg-success{% else %}bg-danger{% endif %}">
        {% if book.status == 'read' %}Read{% else %}Unread{% endif %}
      </span>
    </div>

    <div class="card-body d-flex flex-column p-2">
      <h6 class="card-title mb-1 text-truncate" title="{{ book.title }}">{{ book.title }}</h6>
      <p class="card-text small text-muted text-truncate mb-2" title="{{ book.author }}">{{ book.author }}</p>

      {% if in_community %}
        <!-- Community: show View button -->
        <a href="{% url 'book_detail' book.id %}" class="btn btn-outline-primary btn-sm mt-auto w-100">View</a>
      {% else %}
        <!-- My Collection: whole card clickable -->
        <a href="{% url 'book_detail' book.id %}" class="stretched-link"></a>
      {% endif %}
    </div>
  </div>
</div>
